<!DOCTYPE html>
<!-- saved from url=(0055)http://localhost/using-user-defined-functions-in-spark/ -->
<html class="avada-html-layout-wide avada-html-header-position-top avada-is-100-percent-template ua-windows_nt ua-windows_nt-10 ua-windows_nt-10-0 ua-chrome ua-chrome-136 ua-chrome-136-0 ua-chrome-136-0-0 ua-chrome-136-0-0-0 ua-desktop ua-desktop-windows ua-webkit ua-webkit-537 ua-webkit-537-36 js touchevents no-applicationcache audio audio-ogg audio-mp3 audio-opus audio-wav audio-m4a canvas canvastext hashchange geolocation history inputtypes-search inputtypes-tel inputtypes-url inputtypes-email no-inputtypes-datetime inputtypes-date inputtypes-month inputtypes-week inputtypes-time inputtypes-datetime-local inputtypes-number inputtypes-range inputtypes-color postmessage postmessage-structuredclones video no-video-ogg video-h264 no-video-h265 video-webm video-vp9 no-video-hls no-video-av1 webgl websockets cssanimations backgroundsize borderimage borderradius boxshadow flexbox fontface generatedcontent cssgradients hsla multiplebgs opacity cssreflections rgba textshadow csstransforms supports csstransforms3d csstransitions localstorage sessionstorage no-websqldatabase svgclippaths inlinesvg smil webworkers" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#" data-useragent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Using User-Defined Functions in Spark – DDP Sandbox</title>
<meta name="robots" content="max-image-preview:large">
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel="alternate" type="application/rss+xml" title="DDP Sandbox » Feed" href="http://localhost/feed/">
<link rel="alternate" type="application/rss+xml" title="DDP Sandbox » Comments Feed" href="http://localhost/comments/feed/">
					<link rel="shortcut icon" href="http://localhost/wp-content/uploads/2023/07/favicon.ico" type="image/x-icon">
		
		
		
									<meta name="description" content="Introduction 

One of the most important things in Spark is that you can define your own functions called User defined Functions (UDFs). Which allows us to write our own custom transformations functions that can be used to process data in Spark DataFrames. UDFs can be written in Scala, Java, Python or R.">
				
		<meta property="og:locale" content="en_US">
		<meta property="og:type" content="article">
		<meta property="og:site_name" content="DDP Sandbox">
		<meta property="og:title" content="  Using User-Defined Functions in Spark">
				<meta property="og:description" content="Introduction 

One of the most important things in Spark is that you can define your own functions called User defined Functions (UDFs). Which allows us to write our own custom transformations functions that can be used to process data in Spark DataFrames. UDFs can be written in Scala, Java, Python or R.">
				<meta property="og:url" content="http://localhost/using-user-defined-functions-in-spark/">
										<meta property="article:published_time" content="2023-12-06T00:57:20+00:00">
							<meta property="article:modified_time" content="2024-04-26T19:47:58+00:00">
								<meta name="author" content="Training">
								<meta property="og:image" content="http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354.jpg">
		<meta property="og:image:width" content="1920">
		<meta property="og:image:height" content="1056">
		<meta property="og:image:type" content="image/jpeg">
				<link rel="stylesheet" id="child-style-css" href="./Using User-Defined Functions in Spark – DDP Sandbox_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="fusion-dynamic-css-css" href="./Using User-Defined Functions in Spark – DDP Sandbox_files/106b51cbbc00a733cdf38fe622a84f01.min.css" type="text/css" media="all">
<script type="text/javascript" src="./Using User-Defined Functions in Spark – DDP Sandbox_files/jquery.min.js.download" id="jquery-core-js"></script>
<link rel="https://api.w.org/" href="http://localhost/wp-json/"><link rel="alternate" title="JSON" type="application/json" href="http://localhost/wp-json/wp/v2/posts/4913"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://localhost/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.8.1">
<link rel="canonical" href="http://localhost/using-user-defined-functions-in-spark/">
<link rel="shortlink" href="http://localhost/?p=4913">
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="http://localhost/wp-json/oembed/1.0/embed?url=http%3A%2F%2Flocalhost%2Fusing-user-defined-functions-in-spark%2F">
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="http://localhost/wp-json/oembed/1.0/embed?url=http%3A%2F%2Flocalhost%2Fusing-user-defined-functions-in-spark%2F&amp;format=xml">
<link rel="preload" href="http://localhost/wp-content/themes/Avada/includes/lib/assets/fonts/icomoon/awb-icons.woff" as="font" type="font/woff" crossorigin=""><link rel="preload" href="http://localhost/wp-content/themes/Avada/includes/lib/assets/fonts/fontawesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin=""><link rel="preload" href="http://localhost/wp-content/themes/Avada/includes/lib/assets/fonts/fontawesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin=""><link rel="preload" href="http://localhost/wp-content/themes/Avada/includes/lib/assets/fonts/fontawesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin=""><link rel="preload" href="http://localhost/wp-content/uploads/fusion-icons/avada-handyman-v1.0/fonts/avada-handyman.ttf?g21dbk" as="font" type="font/ttf" crossorigin=""><style type="text/css" id="css-fb-visibility">@media screen and (max-width: 640px){.fusion-no-small-visibility{display:none !important;}body .sm-text-align-center{text-align:center !important;}body .sm-text-align-left{text-align:left !important;}body .sm-text-align-right{text-align:right !important;}body .sm-flex-align-center{justify-content:center !important;}body .sm-flex-align-flex-start{justify-content:flex-start !important;}body .sm-flex-align-flex-end{justify-content:flex-end !important;}body .sm-mx-auto{margin-left:auto !important;margin-right:auto !important;}body .sm-ml-auto{margin-left:auto !important;}body .sm-mr-auto{margin-right:auto !important;}body .fusion-absolute-position-small{position:absolute;top:auto;width:100%;}.awb-sticky.awb-sticky-small{ position: sticky; top: var(--awb-sticky-offset,0); }}@media screen and (min-width: 641px) and (max-width: 1024px){.fusion-no-medium-visibility{display:none !important;}body .md-text-align-center{text-align:center !important;}body .md-text-align-left{text-align:left !important;}body .md-text-align-right{text-align:right !important;}body .md-flex-align-center{justify-content:center !important;}body .md-flex-align-flex-start{justify-content:flex-start !important;}body .md-flex-align-flex-end{justify-content:flex-end !important;}body .md-mx-auto{margin-left:auto !important;margin-right:auto !important;}body .md-ml-auto{margin-left:auto !important;}body .md-mr-auto{margin-right:auto !important;}body .fusion-absolute-position-medium{position:absolute;top:auto;width:100%;}.awb-sticky.awb-sticky-medium{ position: sticky; top: var(--awb-sticky-offset,0); }}@media screen and (min-width: 1025px){.fusion-no-large-visibility{display:none !important;}body .lg-text-align-center{text-align:center !important;}body .lg-text-align-left{text-align:left !important;}body .lg-text-align-right{text-align:right !important;}body .lg-flex-align-center{justify-content:center !important;}body .lg-flex-align-flex-start{justify-content:flex-start !important;}body .lg-flex-align-flex-end{justify-content:flex-end !important;}body .lg-mx-auto{margin-left:auto !important;margin-right:auto !important;}body .lg-ml-auto{margin-left:auto !important;}body .lg-mr-auto{margin-right:auto !important;}body .fusion-absolute-position-large{position:absolute;top:auto;width:100%;}.awb-sticky.awb-sticky-large{ position: sticky; top: var(--awb-sticky-offset,0); }}</style><style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>		<script type="text/javascript">
			var doc = document.documentElement;
			doc.setAttribute( 'data-useragent', navigator.userAgent );
		</script>
		
	<style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style></head>

<body class="wp-singular post-template-default single single-post postid-4913 single-format-standard wp-theme-Avada wp-child-theme-Avada-Child-Theme fusion-image-hovers fusion-pagination-sizing fusion-button_type-flat fusion-button_span-no fusion-button_gradient-linear avada-image-rollover-circle-yes avada-image-rollover-no fusion-body ltr fusion-sticky-header no-tablet-sticky-header no-mobile-sticky-header no-mobile-slidingbar no-mobile-totop fusion-disable-outline fusion-sub-menu-fade mobile-logo-pos-left layout-wide-mode avada-has-boxed-modal-shadow- layout-scroll-offset-full avada-has-zero-margin-offset-top fusion-top-header menu-text-align-center mobile-menu-design-classic fusion-show-pagination-text fusion-header-layout-v3 avada-responsive avada-footer-fx-none avada-menu-highlight-style-bar fusion-search-form-clean fusion-main-menu-search-overlay fusion-avatar-circle avada-dropdown-styles avada-blog-layout-large avada-blog-archive-layout-large avada-header-shadow-no avada-menu-icon-position-left avada-has-megamenu-shadow avada-has-mobile-menu-search avada-has-breadcrumb-mobile-hidden avada-has-titlebar-hide avada-header-border-color-full-transparent avada-has-transparent-timeline_color avada-has-pagination-width_height avada-flyout-menu-direction-fade avada-ec-views-v1 do-animate fusion-no-touch" data-awb-post-id="4913" style="--viewportWidth: 1355; --awb-scrollbar-width: 14px;">
		<a class="skip-link screen-reader-text" href="http://localhost/using-user-defined-functions-in-spark/#content">Skip to content</a>

	<div id="boxed-wrapper">
		
		<div id="wrapper" class="fusion-wrapper">
			<div id="home" style="position:relative;top:-1px;"></div>
												<div class="fusion-tb-header"><div class="fusion-fullwidth fullwidth-box fusion-builder-row-1 fusion-flex-container nonhundred-percent-fullwidth non-hundred-percent-height-scrolling fusion-custom-z-index" style="--link_hover_color: var(--awb-color4);--link_color: var(--awb-color7);--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-z-index:9999;--awb-padding-top:0px;--awb-padding-right:30px;--awb-padding-bottom:0px;--awb-padding-left:30px;--awb-padding-right-small:20px;--awb-padding-left-small:20px;--awb-margin-top:0px;--awb-margin-bottom:0px;--awb-background-color:var(--awb-color8);--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-stretch fusion-flex-content-wrap" style="max-width:1248px;margin-left: calc(-4% / 2 );margin-right: calc(-4% / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-0 fusion_builder_column_1_4 1_4 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:25%;--awb-margin-top-large:0px;--awb-spacing-right-large:7.68%;--awb-margin-bottom-large:0px;--awb-spacing-left-large:7.68%;--awb-width-medium:25%;--awb-order-medium:0;--awb-spacing-right-medium:7.68%;--awb-spacing-left-medium:7.68%;--awb-width-small:50%;--awb-order-small:0;--awb-spacing-right-small:3.84%;--awb-spacing-left-small:3.84%;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-center fusion-content-layout-column"></div></div><div class="fusion-layout-column fusion_builder_column fusion-builder-column-1 fusion_builder_column_3_4 3_4 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:75%;--awb-margin-top-large:0px;--awb-spacing-right-large:2.56%;--awb-margin-bottom-large:0px;--awb-spacing-left-large:2.56%;--awb-width-medium:75%;--awb-order-medium:0;--awb-spacing-right-medium:2.56%;--awb-spacing-left-medium:2.56%;--awb-width-small:50%;--awb-order-small:0;--awb-spacing-right-small:3.84%;--awb-spacing-left-small:3.84%;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><nav class="awb-menu awb-menu_row awb-menu_em-hover mobile-mode-collapse-to-button awb-menu_icons-left awb-menu_dc-yes mobile-trigger-fullwidth-off awb-menu_mobile-toggle awb-menu_indent-left mobile-size-full-absolute mega-menu-loading awb-menu_desktop awb-menu_dropdown awb-menu_expand-right awb-menu_transition-fade" style="--awb-font-size:12px;--awb-text-transform:none;--awb-min-height:35px;--awb-justify-content:flex-end;--awb-items-padding-top:0px;--awb-items-padding-right:25px;--awb-items-padding-bottom:0px;--awb-items-padding-left:25px;--awb-border-color:var(--awb-custom_color_2);--awb-border-right:1px;--awb-border-left:1px;--awb-color:var(--awb-custom_color_2);--awb-active-color:var(--awb-color4);--awb-active-bg:#4a4e57;--awb-active-border-top:1px;--awb-active-border-right:1px;--awb-active-border-bottom:1px;--awb-active-border-left:1px;--awb-submenu-color:var(--awb-color7);--awb-submenu-bg:var(--awb-color1);--awb-submenu-sep-color:var(--awb-color3);--awb-submenu-text-transform:none;--awb-icons-color:var(--awb-custom_color_2);--awb-main-justify-content:flex-start;--awb-mobile-nav-button-align-hor:flex-end;--awb-mobile-nav-items-height:54;--awb-mobile-trigger-font-size:16px;--awb-mobile-trigger-color:var(--awb-color8);--awb-mobile-trigger-background-color:var(--awb-color1);--awb-justify-title:flex-start;--awb-mobile-justify:flex-start;--awb-mobile-caret-left:auto;--awb-mobile-caret-right:0;--awb-fusion-font-family-typography:inherit;--awb-fusion-font-style-typography:normal;--awb-fusion-font-weight-typography:400;--awb-fusion-font-family-submenu-typography:inherit;--awb-fusion-font-style-submenu-typography:normal;--awb-fusion-font-weight-submenu-typography:400;--awb-fusion-font-family-mobile-typography:inherit;--awb-fusion-font-style-mobile-typography:normal;--awb-fusion-font-weight-mobile-typography:400;" aria-label="DDP Top Menu" data-breakpoint="1024" data-count="0" data-transition-type="fade" data-transition-time="300" data-expand="right"><button type="button" class="awb-menu__m-toggle awb-menu__m-toggle_no-text" aria-expanded="false" aria-controls="menu-ddp-top-menu"><span class="awb-menu__m-toggle-inner"><span class="collapsed-nav-text"><span class="screen-reader-text">Toggle Navigation</span></span><span class="awb-menu__m-collapse-icon awb-menu__m-collapse-icon_no-text"><span class="awb-menu__m-collapse-icon-open awb-menu__m-collapse-icon-open_no-text fa-book-open fas"></span><span class="awb-menu__m-collapse-icon-close awb-menu__m-collapse-icon-close_no-text fa-times fas"></span></span></span></button><ul id="menu-ddp-top-menu" class="fusion-menu awb-menu__main-ul awb-menu__main-ul_row"><li id="menu-item-3264" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3264 awb-menu__li awb-menu__main-li awb-menu__main-li_regular" data-item-id="3264"><span class="awb-menu__main-background-default awb-menu__main-background-default_fade"></span><span class="awb-menu__main-background-active awb-menu__main-background-active_fade"></span><a href="http://localhost/instructors/" class="awb-menu__main-a awb-menu__main-a_regular"><span class="menu-text">Instructors</span></a></li><li id="menu-item-4280" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4280 awb-menu__li awb-menu__main-li awb-menu__main-li_regular" data-item-id="4280"><span class="awb-menu__main-background-default awb-menu__main-background-default_fade"></span><span class="awb-menu__main-background-active awb-menu__main-background-active_fade"></span><a href="http://localhost/sandbox-evaluation-survey/" class="awb-menu__main-a awb-menu__main-a_regular"><span class="menu-text">Evaluation Survey</span></a></li><li id="menu-item-4708" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4708 awb-menu__li awb-menu__main-li awb-menu__main-li_regular" data-item-id="4708"><span class="awb-menu__main-background-default awb-menu__main-background-default_fade"></span><span class="awb-menu__main-background-active awb-menu__main-background-active_fade"></span><a href="http://localhost/contact-us/" class="awb-menu__main-a awb-menu__main-a_regular"><span class="menu-text">Contact Us</span></a></li><li id="menu-item-2921" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2921 awb-menu__li awb-menu__main-li awb-menu__main-li_regular" data-item-id="2921"><span class="awb-menu__main-background-default awb-menu__main-background-default_fade"></span><span class="awb-menu__main-background-active awb-menu__main-background-active_fade"></span><a href="http://localhost/about-the-sandbox/" class="awb-menu__main-a awb-menu__main-a_regular"><span class="menu-text">About The Sandbox</span></a></li></ul></nav></div></div></div></div><div class="fusion-fullwidth fullwidth-box fusion-builder-row-2 fusion-flex-container has-pattern-background has-mask-background nonhundred-percent-fullwidth non-hundred-percent-height-scrolling fusion-custom-z-index" style="--awb-background-position:center bottom;--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-z-index:9999;--awb-padding-top:40px;--awb-padding-bottom:45px;--awb-background-color:var(--awb-color1);--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-2 fusion-flex-column fusion-animated" style="--awb-bg-size: cover; --awb-width-large: 30%; --awb-margin-top-large: 0px; --awb-spacing-right-large: 40px; --awb-margin-bottom-large: 0px; --awb-spacing-left-large: 40px; --awb-width-medium: 30%; --awb-order-medium: 0; --awb-spacing-right-medium: 40px; --awb-spacing-left-medium: 40px; --awb-width-small: 50%; --awb-order-small: 0; --awb-spacing-right-small: 0px; --awb-margin-bottom-small: 0px; --awb-spacing-left-small: 40px; visibility: visible; animation-duration: 1.3s;" data-animationtype="fadeIn" data-animationduration="1.3" data-animationoffset="top-into-view"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-center fusion-content-layout-column"><div class="fusion-image-element sm-text-align-left" style="--awb-max-width:231px;--awb-caption-title-font-family:var(--h2_typography-font-family);--awb-caption-title-font-weight:var(--h2_typography-font-weight);--awb-caption-title-font-style:var(--h2_typography-font-style);--awb-caption-title-size:var(--h2_typography-font-size);--awb-caption-title-transform:var(--h2_typography-text-transform);--awb-caption-title-line-height:var(--h2_typography-line-height);--awb-caption-title-letter-spacing:var(--h2_typography-letter-spacing);"><span class=" fusion-imageframe imageframe-none imageframe-1 hover-type-none"><a class="fusion-no-lightbox" href="http://localhost/" target="_self" aria-label="dataxper-logo-invoice-bg-transp"><img decoding="async" width="247" height="96" src="./Using User-Defined Functions in Spark – DDP Sandbox_files/dataxper-logo-invoice-bg-transp.png" data-orig-src="http://localhost/wp-content/uploads/2023/07/dataxper-logo-invoice-bg-transp.png" alt="" class="img-responsive wp-image-1730 lazyautosizes ls-is-cached lazyloaded" srcset="http://localhost/wp-content/uploads/2023/07/dataxper-logo-invoice-bg-transp-200x78.png 200w, http://localhost/wp-content/uploads/2023/07/dataxper-logo-invoice-bg-transp.png 247w" data-srcset="http://localhost/wp-content/uploads/2023/07/dataxper-logo-invoice-bg-transp-200x78.png 200w, http://localhost/wp-content/uploads/2023/07/dataxper-logo-invoice-bg-transp.png 247w" data-sizes="auto" data-orig-sizes="(max-width: 640px) 100vw, 247px" sizes="231px"></a></span></div></div></div><div class="fusion-layout-column fusion_builder_column fusion-builder-column-3 fusion-flex-column fusion-animated" style="--awb-bg-size: cover; --awb-width-large: 70%; --awb-margin-top-large: 0px; --awb-spacing-right-large: 40px; --awb-margin-bottom-large: 0px; --awb-spacing-left-large: 40px; --awb-width-medium: 70%; --awb-order-medium: 1; --awb-spacing-right-medium: 40px; --awb-spacing-left-medium: 40px; --awb-width-small: 50%; --awb-order-small: 1; --awb-spacing-right-small: 40px; --awb-margin-bottom-small: 0px; --awb-spacing-left-small: 0px; visibility: visible; animation-duration: 1.3s;" data-animationtype="fadeIn" data-animationduration="1.3" data-animationoffset="top-into-view" data-scroll-devices="small-visibility,medium-visibility,large-visibility"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-center fusion-content-layout-column"><nav class="awb-menu awb-menu_row awb-menu_em-hover mobile-mode-collapse-to-button awb-menu_icons-left awb-menu_dc-yes mobile-trigger-fullwidth-off awb-menu_mobile-toggle awb-menu_indent-left mobile-size-full-absolute mega-menu-loading awb-menu_desktop awb-menu_dropdown awb-menu_expand-right awb-menu_transition-opacity" style="--awb-font-size:17px;--awb-text-transform:none;--awb-min-height:50px;--awb-gap:42px;--awb-justify-content:flex-end;--awb-border-bottom:0px;--awb-color:var(--awb-color8);--awb-active-color:var(--awb-color1);--awb-active-border-bottom:0px;--awb-active-border-color:var(--awb-color8);--awb-submenu-color:var(--awb-color8);--awb-submenu-bg:var(--awb-color1);--awb-submenu-sep-color:rgba(0,0,0,0);--awb-submenu-border-radius-top-left:6px;--awb-submenu-border-radius-top-right:6px;--awb-submenu-border-radius-bottom-right:6px;--awb-submenu-border-radius-bottom-left:6px;--awb-submenu-active-bg:hsla(var(--awb-color8-h),var(--awb-color8-s),calc( var(--awb-color8-l) + 96% ),var(--awb-color8-a));--awb-submenu-active-color:var(--awb-color8);--awb-submenu-font-size:13px;--awb-submenu-text-transform:none;--awb-icons-color:var(--awb-color8);--awb-icons-hover-color:var(--awb-color7);--awb-main-justify-content:flex-start;--awb-mobile-nav-button-align-hor:flex-end;--awb-mobile-bg:var(--awb-color1);--awb-mobile-color:var(--awb-color8);--awb-mobile-nav-items-height:55;--awb-mobile-active-color:var(--awb-color8);--awb-mobile-trigger-font-size:20px;--awb-trigger-padding-top:6px;--awb-trigger-padding-right:0px;--awb-trigger-padding-bottom:6px;--awb-mobile-trigger-color:var(--awb-color8);--awb-mobile-trigger-background-color:rgba(255,255,255,0);--awb-mobile-nav-trigger-bottom-margin:20px;--awb-mobile-sep-color:var(--awb-color1);--awb-flyout-close-color:var(--awb-color7);--awb-flyout-active-close-color:var(--awb-color7);--awb-mobile-justify:flex-start;--awb-mobile-caret-left:auto;--awb-mobile-caret-right:0;--awb-box-shadow:0px 3px 10px 0px hsla(var(--awb-color8-h),var(--awb-color8-s),var(--awb-color8-l),calc( var(--awb-color8-a) - 97% ));;--awb-fusion-font-family-typography:inherit;--awb-fusion-font-style-typography:normal;--awb-fusion-font-weight-typography:400;--awb-fusion-font-family-submenu-typography:inherit;--awb-fusion-font-style-submenu-typography:normal;--awb-fusion-font-weight-submenu-typography:400;--awb-fusion-font-family-mobile-typography:inherit;--awb-fusion-font-style-mobile-typography:normal;--awb-fusion-font-weight-mobile-typography:400;" aria-label="Sandbox Main Menu" data-breakpoint="840" data-count="1" data-transition-type="center" data-transition-time="300" data-expand="right"><button type="button" class="awb-menu__m-toggle" aria-expanded="false" aria-controls="menu-sandbox-main-menu"><span class="awb-menu__m-toggle-inner"><span class="collapsed-nav-text">Go to...</span><span class="awb-menu__m-collapse-icon"><span class="awb-menu__m-collapse-icon-open fa-bars fas"></span><span class="awb-menu__m-collapse-icon-close fa-times fas"></span></span></span></button><ul id="menu-sandbox-main-menu" class="fusion-menu awb-menu__main-ul awb-menu__main-ul_row"><li id="menu-item-2396" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-2396 awb-menu__li awb-menu__main-li awb-menu__li_button" data-item-id="2396"><a href="http://localhost/" class="awb-menu__main-a awb-menu__main-a_button"><span class="menu-text fusion-button button-default button-medium">Home</span></a></li><li id="menu-item-1837" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1837 awb-menu__li awb-menu__main-li awb-menu__li_button" data-item-id="1837"><a href="http://localhost/quick-links/" class="awb-menu__main-a awb-menu__main-a_button"><span class="menu-text fusion-button button-default button-medium">Quick Links</span></a></li><li id="menu-item-1836" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1836 awb-menu__li awb-menu__main-li awb-menu__li_button" data-item-id="1836"><a href="http://localhost/tutorials/" class="awb-menu__main-a awb-menu__main-a_button"><span class="menu-text fusion-button button-default button-medium">Tutorials</span></a></li><li id="menu-item-2404" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2404 awb-menu__li awb-menu__main-li awb-menu__li_button" data-item-id="2404"><a href="http://localhost/guides" class="awb-menu__main-a awb-menu__main-a_button"><span class="menu-text fusion-button button-default button-medium">Guides</span></a></li><li id="menu-item-5448" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5448 awb-menu__li awb-menu__main-li awb-menu__li_button" data-item-id="5448"><a href="http://localhost/quizzes/" class="awb-menu__main-a awb-menu__main-a_button"><span class="menu-text fusion-button button-default button-medium">Quizzes</span></a></li><li id="menu-item-2400" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2400 awb-menu__li awb-menu__main-li awb-menu__li_button" data-item-id="2400"><a href="http://localhost/frequenty-asked-questions/" class="awb-menu__main-a awb-menu__main-a_button"><span class="menu-text fusion-button button-default button-medium">FAQ</span></a></li></ul></nav></div></div></div></div><div class="fusion-fullwidth fullwidth-box fusion-builder-row-3 fusion-flex-container has-pattern-background has-mask-background hundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--awb-background-position:center bottom;--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-padding-top:-2px;--awb-padding-bottom:-2px;--awb-margin-bottom:-120px;--awb-background-color:var(--awb-color4);--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="width:calc( 100% + 80px ) !important;max-width:calc( 100% + 80px ) !important;margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-4 fusion_builder_column_1_1 1_1 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:100%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:-2px;--awb-spacing-left-large:40px;--awb-width-medium:100%;--awb-order-medium:3;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:3;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;" data-scroll-devices="small-visibility,medium-visibility,large-visibility"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-section-separator section-separator paper fusion-section-separator-1" style="--awb-spacer-height:30px;--awb-divider-height:30px;--awb-spacer-padding-top:inherit;--awb-bg-size:100% 30px;--awb-bg-size-medium:100% 100%;--awb-bg-size-small:100% 100%;"><div class="fusion-section-separator-svg fusion-section-separator-fullwidth"><div class="fusion-paper-candy-sep fusion-section-separator-svg-bg" style="background-image:url( data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.1%22%20width%3D%22100%25%22%20viewBox%3D%220%200%201667%20102%22%20preserveAspectRatio%3D%22none%22%20fill%3D%22rgba%28255%2C255%2C255%2C1%29%22%3E%3Cpath%20d%3D%22M0%20102V18L14%2023H34L43%2028H70L83%2023L88%2018L110%2023L165%2038C169.13%2036.9132%20174.712%2035.4721%20180.5%2034.0232C184.719%2032.9671%20190.047%2035.9301%20194%2035C201.258%2033.2924%20206.255%2028%20208%2028C209.361%2028%20213.031%2030.7641%20215.5%2029.5C216.777%2028.8461%20216.634%2024.4684%20218%2023.652C221.756%2021.407%20227.081%2029.2742%20229.5%2027.5L240.5%2020.625H249.5L256%2017.4737L267%2014L278%2025L280.5%2031.652L287%2029.5L291.5%2035.5L298%2038L304%2035.5L314%2038L325%2037L329.5%2038H336L348%2035.5L354%2028H365L370.5%2020.5L382.5%2020.875L389.5%2017L402%2020.875L409.5%2017L424.5%2018.5L435.5%2017L451%2018.5L463%2017L471.5%2023L478.5%2020.875L487%2024.5L498.5%2025.5L505%2028H510C510.958%2029.5968%20510.605%2033.4726%20512.5%2035.5C514.561%2037.7047%20518.916%2038%20521%2038H530L585%2028L616%2017L632%2010L651.5%2013.5L668.5%2021.7L676.5%2018.1L686%2023.5L694.5%2021.7L705.5%2027.5L717%2026.2L727%2030.6786H733.5L744%2037.5L754%2038L786%2028H814L868%2017L887%2019.1111L898%2023L910%2021.6667L917%2024L927%2022.3333L933%2024L943.5%2020.1957L956.5%2021L964%2017.5217L968%2017L980%2010H1005L1015%2017H1052L1110%2010L1132%200L1141%201.8L1156.5%208L1165.5%206.7L1180.5%2011.625H1188.75L1195.5%2014.6944H1201.5L1209.5%2018L1221%2019.3889L1235%2027L1268%2038L1311%2028L1316%2023L1338%2017L1354%2028L1364%2038L1392%2028.6667L1404.5%2030L1409%2023H1419.5L1427%2017L1437%2020L1445%2028.6667L1456%2023L1470.5%2028.6667L1497.5%2017L1505%2010L1514%2013L1522%2010L1530.5%2012L1536%205L1543.5%208.05L1553%205.40854L1563%2010L1567%200L1584%208.05L1594%206.55L1604.5%202L1614.5%204.75L1631%2011.5L1647.5%208.05L1667%2018V102H0Z%22%20fill%3D%22var%28--awb-color1%29%22%2F%3E%3C%2Fsvg%3E );transform: rotateX(180deg);"></div></div><div class="fusion-section-separator-spacer fusion-section-separator-fullwidth"><div class="fusion-section-separator-spacer-height"></div></div></div></div></div><div class="fusion-layout-column fusion_builder_column fusion-builder-column-5 fusion_builder_column_1_1 1_1 fusion-flex-column menu-underlay fusion-animated" style="--awb-padding-top: 70px; --awb-padding-bottom: 147px; --awb-padding-top-small: 50px; --awb-padding-bottom-small: 165px; --awb-bg-color: var(--awb-color4); --awb-bg-color-hover: var(--awb-color4); --awb-bg-size: cover; --awb-border-color: hsla(var(--awb-color8-h),var(--awb-color8-s),var(--awb-color8-l),calc( var(--awb-color8-a) - 83% )); --awb-border-top: 0; --awb-border-style: solid; --awb-width-large: 100%; --awb-margin-top-large: -2px; --awb-spacing-right-large: 40px; --awb-margin-bottom-large: 0px; --awb-spacing-left-large: 40px; --awb-width-medium: 100%; --awb-order-medium: 2; --awb-spacing-right-medium: 40px; --awb-spacing-left-medium: 40px; --awb-width-small: 100%; --awb-order-small: 2; --awb-spacing-right-small: 40px; --awb-spacing-left-small: 40px; visibility: visible; animation-duration: 1s;" data-animationtype="fadeIn" data-animationduration="1.0" data-animationoffset="top-into-view" data-scroll-devices="small-visibility,medium-visibility,large-visibility"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-title title fusion-title-1 fusion-sep-none fusion-title-center fusion-title-text fusion-title-size-one" style="--awb-text-color:var(--awb-color8);--awb-margin-top:-5px;--awb-font-size:54px;"><h1 class="fusion-title-heading title-heading-center" style="margin:0;font-size:1em;letter-spacing:-1px;text-transform:capitalize;">Using User-Defined Functions in Spark</h1></div></div></div><div class="fusion-layout-column fusion_builder_column fusion-builder-column-6 fusion_builder_column_1_1 1_1 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:100%;--awb-margin-top-large:-2px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:0px;--awb-spacing-left-large:40px;--awb-width-medium:100%;--awb-order-medium:3;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:3;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;" data-scroll-devices="small-visibility,medium-visibility,large-visibility"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-section-separator section-separator paper fusion-section-separator-2" style="--awb-spacer-height:30px;--awb-divider-height:30px;--awb-spacer-padding-top:inherit;--awb-bg-size:100% 30px;--awb-bg-size-medium:100% 100%;--awb-bg-size-small:100% 100%;"><div class="fusion-section-separator-svg fusion-section-separator-fullwidth"><div class="fusion-paper-candy-sep fusion-section-separator-svg-bg" style="background-image:url( data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20version%3D%221.1%22%20width%3D%22100%25%22%20viewBox%3D%220%200%201667%20102%22%20preserveAspectRatio%3D%22none%22%20fill%3D%22rgba%28255%2C255%2C255%2C1%29%22%3E%3Cpath%20d%3D%22M0%20102V18L14%2023H34L43%2028H70L83%2023L88%2018L110%2023L165%2038C169.13%2036.9132%20174.712%2035.4721%20180.5%2034.0232C184.719%2032.9671%20190.047%2035.9301%20194%2035C201.258%2033.2924%20206.255%2028%20208%2028C209.361%2028%20213.031%2030.7641%20215.5%2029.5C216.777%2028.8461%20216.634%2024.4684%20218%2023.652C221.756%2021.407%20227.081%2029.2742%20229.5%2027.5L240.5%2020.625H249.5L256%2017.4737L267%2014L278%2025L280.5%2031.652L287%2029.5L291.5%2035.5L298%2038L304%2035.5L314%2038L325%2037L329.5%2038H336L348%2035.5L354%2028H365L370.5%2020.5L382.5%2020.875L389.5%2017L402%2020.875L409.5%2017L424.5%2018.5L435.5%2017L451%2018.5L463%2017L471.5%2023L478.5%2020.875L487%2024.5L498.5%2025.5L505%2028H510C510.958%2029.5968%20510.605%2033.4726%20512.5%2035.5C514.561%2037.7047%20518.916%2038%20521%2038H530L585%2028L616%2017L632%2010L651.5%2013.5L668.5%2021.7L676.5%2018.1L686%2023.5L694.5%2021.7L705.5%2027.5L717%2026.2L727%2030.6786H733.5L744%2037.5L754%2038L786%2028H814L868%2017L887%2019.1111L898%2023L910%2021.6667L917%2024L927%2022.3333L933%2024L943.5%2020.1957L956.5%2021L964%2017.5217L968%2017L980%2010H1005L1015%2017H1052L1110%2010L1132%200L1141%201.8L1156.5%208L1165.5%206.7L1180.5%2011.625H1188.75L1195.5%2014.6944H1201.5L1209.5%2018L1221%2019.3889L1235%2027L1268%2038L1311%2028L1316%2023L1338%2017L1354%2028L1364%2038L1392%2028.6667L1404.5%2030L1409%2023H1419.5L1427%2017L1437%2020L1445%2028.6667L1456%2023L1470.5%2028.6667L1497.5%2017L1505%2010L1514%2013L1522%2010L1530.5%2012L1536%205L1543.5%208.05L1553%205.40854L1563%2010L1567%200L1584%208.05L1594%206.55L1604.5%202L1614.5%204.75L1631%2011.5L1647.5%208.05L1667%2018V102H0Z%22%20fill%3D%22var%28--awb-color1%29%22%2F%3E%3C%2Fsvg%3E );"></div></div><div class="fusion-section-separator-spacer fusion-section-separator-fullwidth"><div class="fusion-section-separator-spacer-height"></div></div></div></div></div></div></div>
</div>		<div id="sliders-container" class="fusion-slider-visibility">
					</div>
											
			
						<main id="main" class="clearfix width-100">
				<div class="fusion-row" style="max-width:100%;">

<section id="content" style="width: 100%;">
									<div id="post-4913" class="post-4913 post type-post status-publish format-standard has-post-thumbnail hentry category-spark">

				<div class="post-content">
					<div class="fusion-fullwidth fullwidth-box fusion-builder-row-4 fusion-flex-container has-pattern-background has-mask-background nonhundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-padding-bottom:90px;--awb-padding-top-small:40px;--awb-padding-bottom-small:0px;--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-justify-content-center fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-7 fusion_builder_column_1_1 1_1 fusion-flex-column fusion-animated" style="--awb-bg-color: var(--awb-color1); --awb-bg-color-hover: var(--awb-color1); --awb-bg-size: cover; --awb-width-large: 100%; --awb-margin-top-large: 0px; --awb-spacing-right-large: 40px; --awb-margin-bottom-large: 70px; --awb-spacing-left-large: 40px; --awb-width-medium: 100%; --awb-order-medium: 0; --awb-spacing-right-medium: 40px; --awb-spacing-left-medium: 40px; --awb-width-small: 100%; --awb-order-small: 0; --awb-margin-top-small: -80px; --awb-spacing-right-small: 40px; --awb-spacing-left-small: 40px; visibility: visible; animation-duration: 1s;" data-animationtype="fadeInUp" data-animationduration="1.0" data-animationoffset="top-into-view" data-scroll-devices="small-visibility,medium-visibility,large-visibility"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-image-element " style="text-align:center;--awb-caption-title-font-family:var(--h2_typography-font-family);--awb-caption-title-font-weight:var(--h2_typography-font-weight);--awb-caption-title-font-style:var(--h2_typography-font-style);--awb-caption-title-size:var(--h2_typography-font-size);--awb-caption-title-transform:var(--h2_typography-text-transform);--awb-caption-title-line-height:var(--h2_typography-line-height);--awb-caption-title-letter-spacing:var(--h2_typography-letter-spacing);"><span class=" fusion-imageframe imageframe-none imageframe-2 hover-type-none"><img fetchpriority="high" decoding="async" width="1920" height="1056" alt="using-user-defined-functions-in-spark" title="using-user-defined-functions-in-spark" src="./Using User-Defined Functions in Spark – DDP Sandbox_files/shutterstock_1512536354.jpg" data-orig-src="http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354.jpg" class="img-responsive wp-image-5023 lazyautosizes lazyloaded" srcset="http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354-200x110.jpg 200w, http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354-400x220.jpg 400w, http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354-600x330.jpg 600w, http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354-800x440.jpg 800w, http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354-1200x660.jpg 1200w, http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354.jpg 1920w" data-srcset="http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354-200x110.jpg 200w, http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354-400x220.jpg 400w, http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354-600x330.jpg 600w, http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354-800x440.jpg 800w, http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354-1200x660.jpg 1200w, http://localhost/wp-content/uploads/2023/12/shutterstock_1512536354.jpg 1920w" data-sizes="auto" data-orig-sizes="(max-width: 640px) 100vw, 1200px" sizes="1200px"></span></div></div></div><div class="fusion-layout-column fusion_builder_column fusion-builder-column-8 fusion_builder_column_1_1 1_1 fusion-flex-column fusion-animated" style="--awb-bg-size: cover; --awb-width-large: 100%; --awb-margin-top-large: 0px; --awb-spacing-right-large: 40px; --awb-margin-bottom-large: 20px; --awb-spacing-left-large: 40px; --awb-width-medium: 100%; --awb-order-medium: 0; --awb-spacing-right-medium: 40px; --awb-spacing-left-medium: 40px; --awb-width-small: 100%; --awb-order-small: 0; --awb-spacing-right-small: 40px; --awb-margin-bottom-small: 0px; --awb-spacing-left-small: 40px; visibility: visible; animation-duration: 1s;" data-animationtype="fadeInDown" data-animationduration="1.0" data-animationoffset="top-into-view"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-content-tb fusion-content-tb-1"><div class="fusion-fullwidth fullwidth-box fusion-builder-row-4-1 fusion-flex-container has-pattern-background has-mask-background nonhundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-9 fusion_builder_column_1_1 1_1 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:100%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:20px;--awb-spacing-left-large:40px;--awb-width-medium:100%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="accordian fusion-accordian" style="--awb-border-size:3px;--awb-icon-size:16px;--awb-content-font-size:var(--awb-typography4-font-size);--awb-icon-alignment:left;--awb-hover-color:var(--awb-color1);--awb-border-color:var(--awb-color4);--awb-background-color:var(--awb-color1);--awb-divider-color:var(--awb-color3);--awb-divider-hover-color:var(--awb-color3);--awb-icon-color:var(--awb-color4);--awb-title-color:var(--awb-color8);--awb-content-color:var(--awb-color8);--awb-icon-box-color:var(--awb-color7);--awb-toggle-hover-accent-color:var(--awb-color4);--awb-title-font-family:var(--awb-typography1-font-family);--awb-title-font-weight:var(--awb-typography1-font-weight);--awb-title-font-style:var(--awb-typography1-font-style);--awb-content-font-family:var(--awb-typography4-font-family);--awb-content-font-weight:var(--awb-typography4-font-weight);--awb-content-font-style:var(--awb-typography4-font-style);"><div class="panel-group fusion-toggle-icon-unboxed" id="accordion-4913-1"><div class="fusion-panel panel-default panel-7a1c6f1bf42aaae92 fusion-toggle-no-divider fusion-toggle-boxed-mode" style="--awb-title-color:var(--awb-color8);"><div class="panel-heading"><h4 class="panel-title toggle" id="toggle_7a1c6f1bf42aaae92"><a aria-expanded="false" aria-controls="7a1c6f1bf42aaae92" role="button" data-toggle="collapse" data-parent="#accordion-4913-1" data-target="#7a1c6f1bf42aaae92" href="http://localhost/using-user-defined-functions-in-spark/#7a1c6f1bf42aaae92"><span class="fusion-toggle-icon-wrapper" aria-hidden="true"><i class="fa-fusion-box active-icon awb-icon-minus" aria-hidden="true"></i><i class="fa-fusion-box inactive-icon awb-icon-plus" aria-hidden="true"></i></span><span class="fusion-toggle-heading">Table of Contents</span></a></h4></div><div id="7a1c6f1bf42aaae92" class="panel-collapse collapse " aria-labelledby="toggle_7a1c6f1bf42aaae92"><div class="panel-body toggle-content fusion-clearfix">
<div class="awb-toc-el awb-toc-el--1" data-awb-toc-id="1" data-awb-toc-options="{&quot;allowed_heading_tags&quot;:{&quot;h2&quot;:0,&quot;h3&quot;:1},&quot;ignore_headings&quot;:&quot;&quot;,&quot;ignore_headings_words&quot;:&quot;Content&quot;,&quot;enable_cache&quot;:&quot;yes&quot;,&quot;highlight_current_heading&quot;:&quot;no&quot;,&quot;hide_hidden_titles&quot;:&quot;yes&quot;,&quot;limit_container&quot;:&quot;post_content&quot;,&quot;select_custom_headings&quot;:&quot;&quot;,&quot;icon&quot;:&quot;fa-flag fas&quot;,&quot;counter_type&quot;:&quot;decimal&quot;}" style="--awb-counter-type:counters(awb-toc, &quot;.&quot;, decimal) &quot;. &quot;;--awb-item-overflow:hidden;--awb-item-white-space:nowrap;--awb-item-text-overflow:ellipsis;"><div class="awb-toc-el__content"><ul class="awb-toc-el__list awb-toc-el__list--0"><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Introduction">Introduction</a></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Why_do_we_need_a_Spark_UDF">Why do we need a Spark UDF ?</a></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Types_of_UDFs">Types of UDFs</a><ul class="awb-toc-el__list awb-toc-el__list--1"><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Performance_Association_with_UDFs">Performance Association with UDFs</a></li></ul></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Dataset_Description">Dataset Description</a></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Upload_The_Input_Dataset_on_HDFS">Upload The Input Dataset on HDFS</a></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Loading_The_File_Into_Spark_Dataframe">Loading The File Into Spark Dataframe</a><ul class="awb-toc-el__list awb-toc-el__list--1"><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Weather_Dataframe_Exploration">Weather Dataframe Exploration</a></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Check_Data_Is_Loaded">Check Data Is Loaded</a></li></ul></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Creating_and_Using_UserDefined_Functions_UDFs">Creating and Using User-Defined Functions (UDFs)</a><ul class="awb-toc-el__list awb-toc-el__list--1"><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Step_1_Import_the_necessary_libraries">Step 1: Import the necessary libraries</a></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Step_2_Define_the_UDF_logic">Step 2: Define the UDF logic</a></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Step_3_Convert_the_UDF_to_a_SparkSQL">Step 3: Convert the UDF to a SparkSQL UDF</a></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Step_4_Apply_the_UDF_to_our_data">Step 4: Apply the UDF to our data</a></li></ul></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Registering_the_UDF">Registering the UDF</a></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Dropping_the_UDF">Dropping the UDF</a></li><li class="awb-toc-el__list-item"><a class="awb-toc-el__item-anchor" href="http://localhost/using-user-defined-functions-in-spark/#toc_Summary">Summary</a></li></ul></div></div>
</div></div></div></div></div>
<div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:64px;width:100%;"></div><div class="fusion-title title fusion-title-2 sep-underline sep-solid fusion-title-text fusion-title-size-two" style="--awb-sep-color:var(--awb-color4);"><h2 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Introduction">Introduction</h2></div><div class="fusion-text fusion-text-1"><p>One of the most important things in Spark is that you can define your own functions called <span style="color: #0000ff;">User defined Functions (UDFs)</span>. Which allows us to write our own&nbsp;custom transformations functions that can be used to process data in Spark DataFrames. UDFs can be written in Scala, Java, Python or R.</p>
</div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:36px;width:100%;"></div></div></div></div></div><div class="fusion-fullwidth fullwidth-box fusion-builder-row-4-2 fusion-flex-container has-pattern-background has-mask-background nonhundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-10 fusion_builder_column_1_1 1_1 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:100%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:20px;--awb-spacing-left-large:40px;--awb-width-medium:100%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-title title fusion-title-3 sep-underline sep-solid fusion-title-text fusion-title-size-two" style="--awb-sep-color:var(--awb-color4);"><h2 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Why_do_we_need_a_Spark_UDF">Why do we need a Spark UDF ?</h2></div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:20px;width:100%;"></div><div class="fusion-text fusion-text-2"><p>UDF’s are used to extend the functions of the framework and re-use this function on several DataFrame. For example if you wanted to convert the every first letter of a word in a sentence to capital case, Spark build-in features doesn’t have this function hence you can create it as UDF and reuse this as needed on many DataFrames. UDF’s are once created they can be re-use on several DataFrame’s and SQL expressions.</p>
</div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:20px;width:100%;"></div><div class="fusion-title title fusion-title-4 sep-underline sep-solid fusion-title-text fusion-title-size-two" style="--awb-sep-color:var(--awb-color4);"><h2 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Types_of_UDFs">Types of UDFs</h2></div><div class="fusion-text fusion-text-3"><p>Basically, there are three types of UDFs available in Spark:</p>
<ul>
<li><strong>Scalar UDFs:</strong><br>
UDFs that take one or more input columns and return a single output column are known as Scala UDFs.</li>
</ul>
<ul>
<li><strong>Aggregate UDFs:</strong><br>
UDFs take one or more input columns and return a single output value after aggregating the input data.</li>
</ul>
<ul>
<li><strong>Vector UDFs:</strong><br>
A Vector in Spark can be defined as a dense or sparse vector of doubles that is used to represent a feature vector in machine learning applications Vector UDFs allow us to define custom functions that operate on Vector columns in Spark DataFrames.</li>
</ul>
<p>In this tutorial we will cover the Scalar UDFs only.</p>
</div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:20px;width:100%;"></div><div class="fusion-title title fusion-title-5 sep-underline sep-solid fusion-title-text fusion-title-size-three" style="--awb-sep-color:var(--awb-color4);"><h3 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Performance_Association_with_UDFs">Performance Association with UDFs</h3></div><div class="fusion-text fusion-text-4"><p>Using UDFs can be an expensive process, as they may require data serialization and deserialization. Therefore, it’s important to use UDFs judiciously and only when built-in functions cannot meet your requirements.</p>
<p>Let’s explore these implications in detail:</p>
<ol start="">
<li><strong>Serialization and Deserialization Overhead:</strong><br>
When using UDFs, the data needs to be serialized and deserialized between the JVM and the user-defined function this leads to significant performance overhead.</li>
</ol>
<ol start="2">
<li><strong>Garbage Collection:</strong><br>
While using UDFs they can create temporary objects that can accumulate in the JVM heap, leading to garbage collection overhead.</li>
</ol>
<ol start="3">
<li><strong>Resource Utilization:</strong><br>
UDFs can easily chew up loads of your resources, such as CPU and memory. So it’s necessary you carefully tune the Spark configuration parameters, such as spark.driver.memory, spark.executor.memory, spark.executor.cores, and spark.executor.instances.</li>
</ol>
<ol start="4">
<li><strong>Data Skew:</strong><br>
UDFs can cause data skew, where some partitions have significantly more data than others. This can result in performance degradation and resource contention.</li>
</ol>
</div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:20px;width:100%;"></div></div></div></div></div><div class="fusion-fullwidth fullwidth-box fusion-builder-row-4-3 fusion-flex-container has-pattern-background has-mask-background nonhundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--link_color: #8c0f0f;--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-11 fusion_builder_column_1_1 1_1 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:100%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:20px;--awb-spacing-left-large:40px;--awb-width-medium:100%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-title title fusion-title-6 sep-underline sep-solid fusion-title-text fusion-title-size-two" style="--awb-sep-color:var(--awb-color4);"><h2 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Dataset_Description">Dataset Description</h2></div><div class="fusion-text fusion-text-5"><p>In this tutorial, we will be using the weather observations dataset <span style="color: #800080;">(2021-1k.csv</span>). The file has 8 columns but we are interested in the first 4 columns described as following:</p>
<p></p>
<div class="table-2">
<table width="100%">
<thead>
<tr>
<th align="left">Field</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>ID</strong></td>
<td align="left">11 character station identification code.</td>
</tr>
<tr>
<td align="left"><strong>YEAR/MONTH/DAY</strong></td>
<td align="left">8 character date in YYYYMMDD format (e.g. 19860529 = May 29, 1986).</td>
</tr>
<tr>
<td align="left"><strong>ELEMENT</strong></td>
<td align="left">4 character indicator of element type.</td>
</tr>
<tr>
<td align="left"><strong>DATA VALUE</strong></td>
<td align="left">5 character data value for ELEMENT.</td>
</tr>
<tr>
<td align="left"><strong>M-FLAG</strong></td>
<td align="left">1 character Measurement Flag.</td>
</tr>
<tr>
<td align="left"><strong>Q-FLAG</strong></td>
<td align="left">1 character Quality Flag.</td>
</tr>
<tr>
<td align="left"><strong>S-FLAG</strong></td>
<td align="left">1 character Source Flag.</td>
</tr>
<tr>
<td align="left"><strong>OBS-TIME</strong></td>
<td align="left">4-character time of observation in hour-minute format (i.e. 0700 =7:00 am).</td>
</tr>
</tbody>
</table>
</div>
<p>
</p><p>The input data set contains data for one month or more daily weather data.</p>
</div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:32px;width:100%;"></div></div></div></div></div><div class="fusion-fullwidth fullwidth-box fusion-builder-row-4-4 fusion-flex-container has-pattern-background has-mask-background nonhundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--link_color: var(--awb-custom_color_3);--awb-border-sizes-top:1;--awb-border-sizes-bottom:1;--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-background-color:var(--awb-color2);--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-12 fusion_builder_column_1_2 1_2 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:50%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:20px;--awb-spacing-left-large:40px;--awb-width-medium:50%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:25px;width:100%;"></div><div class="fusion-text fusion-text-6"><p>To execute the Spark statements of this tutorial we will be using a Zeppelin note with the <span style="color: #0000ff;"><strong>spark </strong></span>interpreter (<span style="color: #0000ff;"><strong>%spark</strong></span>).</p>
</div></div></div><div class="fusion-layout-column fusion_builder_column fusion-builder-column-13 fusion_builder_column_1_2 1_2 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:50%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:20px;--awb-spacing-left-large:40px;--awb-width-medium:50%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;" data-scroll-devices="small-visibility,medium-visibility,large-visibility"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:10px;width:100%;"></div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-1 > .CodeMirror, .fusion-syntax-highlighter-1 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-1 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-1 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-1 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_1" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_1" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_1" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark

sc.version</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99316px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -14px; border-right-width: 16px; min-height: 88px; min-width: 102.388px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9984px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.993px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.993px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.993px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sc</span>.<span class="cm-property">version</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 16px; width: 1px; border-bottom: 0px solid transparent; top: 88px;"></div><div class="CodeMirror-gutters" style="height: 104px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div></div></div><div class="fusion-fullwidth fullwidth-box fusion-builder-row-4-5 fusion-flex-container has-pattern-background has-mask-background nonhundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-14 fusion_builder_column_1_1 1_1 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:100%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:20px;--awb-spacing-left-large:40px;--awb-width-medium:100%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:64px;width:100%;"></div><div class="fusion-title title fusion-title-7 sep-underline sep-solid fusion-title-text fusion-title-size-two" style="--awb-sep-color:var(--awb-color4);"><h2 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Upload_The_Input_Dataset_on_HDFS">Upload The Input Dataset on HDFS</h2></div><div class="fusion-text fusion-text-7"><p>To load the the CSV file into a Spark DataFrame, let’s upload it on HDFS. We start by creating a directory on HDFS and then put the file into this directory.</p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-2 > .CodeMirror, .fusion-syntax-highlighter-2 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-2 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-2 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-2 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_2" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_2" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_2" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/x-sh" style="display: none;">%sh
# upload data to hdfs

hdfs dfs -mkdir -p /tutorials/spark/udfs

hdfs dfs -put /home/training/Data/2021-1k.csv /tutorials/spark/udfs/</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99292px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 167px; min-width: 562.739px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">%sh</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># upload data to hdfs</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">hdfs dfs <span class="cm-attribute">-mkdir</span> <span class="cm-attribute">-p</span> /tutorials/spark/udfs</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">hdfs dfs <span class="cm-attribute">-put</span> /home/training/Data/2021-1k.csv /tutorials/spark/udfs/</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 167px;"></div><div class="CodeMirror-gutters" style="height: 182px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:25px;width:100%;"></div><div class="fusion-text fusion-text-8"><ol start="1">
<li>
<h2 id="toc_Loading_The_File_Into_Spark_Dataframe">Loading The File Into Spark Dataframe</h2>
</li>
</ol>
<p>The easiest way to load the csv file into a Spark dataframe is to use the <span style="color: #ff9900;"><strong>read.format</strong> </span>function (Spark SQL API). The input file has no&nbsp; header. We will instruct the function to infer the schema as we didn’t provide it explicitly. The input data is coma (<span style="color: #0000ff;"><strong>,</strong></span>) separated and we provide the columns names explicitly.</p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-3 > .CodeMirror, .fusion-syntax-highlighter-3 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-3 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-3 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-3 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_3" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_3" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_3" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark
// load the file using the SparkSQL API

val weather = spark.read
        .format("csv")
        .option("header","false")
        .option("inferSchema","true")
        .load("/tutorials/spark/udfs/2021-1k.csv")
        .toDF("id", "date", "element", "celsius", "f1", "f2", "f3", "f4")
        .cache</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99268px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 274px; min-width: 602.521px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>10</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// load the file using the SparkSQL API</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">val</span> <span class="cm-variable">weather</span> <span class="cm-operator">=</span> <span class="cm-variable">spark</span>.<span class="cm-property">read</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        .<span class="cm-property">format</span>(<span class="cm-string">"csv"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        .<span class="cm-property">option</span>(<span class="cm-string">"header"</span>,<span class="cm-string">"false"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        .<span class="cm-property">option</span>(<span class="cm-string">"inferSchema"</span>,<span class="cm-string">"true"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        .<span class="cm-property">load</span>(<span class="cm-string">"/tutorials/spark/udfs/2021-1k.csv"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        .<span class="cm-property">toDF</span>(<span class="cm-string">"id"</span>, <span class="cm-string">"date"</span>, <span class="cm-string">"element"</span>, <span class="cm-string">"celsius"</span>, <span class="cm-string">"f1"</span>, <span class="cm-string">"f2"</span>, <span class="cm-string">"f3"</span>, <span class="cm-string">"f4"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">        .<span class="cm-property">cache</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 274px;"></div><div class="CodeMirror-gutters" style="height: 289px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-text fusion-text-9"><ol start="2">
<li>
<h3 id="toc_Weather_Dataframe_Exploration">Weather Dataframe Exploration</h3>
</li>
</ol>
<p>Let’s explore the newly loaded dataframe. First we will print its schema. Then we will perform a row count on the dataframe<em>.&nbsp;</em></p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-4 > .CodeMirror, .fusion-syntax-highlighter-4 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-4 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-4 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-4 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_4" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_4" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_4" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark
// Print the dataframe schema

weather.printSchema</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99268px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 114px; min-width: 253.182px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Print the dataframe schema</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">weather</span>.<span class="cm-property">printSchema</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 114px;"></div><div class="CodeMirror-gutters" style="height: 129px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-text fusion-text-10"><ol start="3">
<li>
<h3 id="toc_Check_Data_Is_Loaded">Check Data Is Loaded</h3>
</li>
</ol>
<p>Use <span style="color: #800080;">show </span>to verify that the data have been loaded properly. Include <span style="color: #800080;">LIMIT </span>to retrieve only the first 10 rows.</p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-5 > .CodeMirror, .fusion-syntax-highlighter-5 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-5 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-5 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-5 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_5" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_5" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_5" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark
// Show first 10 rows

weather.show(10)</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99316px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 114px; min-width: 189.682px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Show first 10 rows</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">weather</span>.<span class="cm-property">show</span>(<span class="cm-number">10</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 114px;"></div><div class="CodeMirror-gutters" style="height: 129px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:25px;width:100%;"></div><div class="fusion-text fusion-text-11"><p>Count the number of rows in the dataframe.</p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-6 > .CodeMirror, .fusion-syntax-highlighter-6 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-6 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-6 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-6 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_6" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_6" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_6" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark
// Show the row count

weather.count</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99316px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 114px; min-width: 189.682px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Show the row count</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">weather</span>.<span class="cm-property">count</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 114px;"></div><div class="CodeMirror-gutters" style="height: 129px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:64px;width:100%;"></div></div></div></div></div><div class="fusion-fullwidth fullwidth-box fusion-builder-row-4-6 fusion-flex-container has-pattern-background has-mask-background nonhundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-15 fusion_builder_column_1_1 1_1 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:100%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:20px;--awb-spacing-left-large:40px;--awb-width-medium:100%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-title title fusion-title-8 sep-underline sep-solid fusion-title-text fusion-title-size-two" style="--awb-sep-color:var(--awb-color4);"><h2 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Creating_and_Using_UserDefined_Functions_UDFs">Creating and Using User-Defined Functions (UDFs)</h2></div><div class="fusion-text fusion-text-12"><p>Spark SQL provides several predefined common functions and many more new functions are added with every release. hence, It is best to check before you jump into coding your function if&nbsp; the similar function you wanted is already available in Spark SQL Functions.</p>
<p>When you creating UDF’s you need to design them very carefully otherwise you will come across performance issues.</p>
</div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:30px;width:100%;"></div><div class="fusion-title title fusion-title-9 sep-underline sep-solid fusion-title-text fusion-title-size-three" style="--awb-sep-color:var(--awb-color4);"><h3 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Step_1_Import_the_necessary_libraries">Step 1: Import the necessary libraries</h3></div><div class="fusion-text fusion-text-13"><p>The&nbsp;<span style="color: #ff6600;"><strong>udf&nbsp;</strong></span>function is provided by the<span style="color: #0000ff;">&nbsp;org.apache.spark.sql.functions</span>&nbsp;package, and we will use it to create our UDF.</p>
<p>We will start by importing the necessary libraries for our code to work:</p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-7 > .CodeMirror, .fusion-syntax-highlighter-7 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-7 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-7 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-7 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_7" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_7" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_7" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark
// Import libraries

import spark.implicits._
import org.apache.spark.sql.functions.{udf}</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99316px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 141px; min-width: 364.384px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Import libraries</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-def">spark</span>.<span class="cm-variable">implicits</span>.<span class="cm-property">_</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-def">org</span>.<span class="cm-variable">apache</span>.<span class="cm-property">spark</span>.<span class="cm-property">sql</span>.<span class="cm-property">functions</span>.{<span class="cm-variable">udf</span>}</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 141px;"></div><div class="CodeMirror-gutters" style="height: 156px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:30px;width:100%;"></div><div class="fusion-title title fusion-title-10 sep-underline sep-solid fusion-title-text fusion-title-size-three" style="--awb-sep-color:var(--awb-color4);"><h3 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Step_2_Define_the_UDF_logic">Step 2: Define the UDF logic</h3></div><div class="fusion-text fusion-text-14"><p>Next, we will define our UDF logic.</p>
<p>We want to create a UDF that convert an integer representing <a href="https://en.wikipedia.org/wiki/Fahrenheit">Celsius</a> degrees to its corresponding value in <a href="https://en.wikipedia.org/wiki/Fahrenheit">Fahrenheit</a> degrees. We will define a function that takes an Integer as an Input and returns a Double that is the Fahrenheit value. (<a href="https://en.wikipedia.org/wiki/Fahrenheit">https://en.wikipedia.org/wiki/Fahrenheit</a>).</p>
<p><a href="./Using User-Defined Functions in Spark – DDP Sandbox_files/celsius-fahrenheit-formula.jpg" data-caption=""><img decoding="async" class="alignleft size-full wp-image-4938 lazyautosizes lazyloaded" src="./Using User-Defined Functions in Spark – DDP Sandbox_files/celsius-fahrenheit-formula.jpg" data-orig-src="http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-formula.jpg" alt="" width="421" height="247" srcset="http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-formula-200x117.jpg 200w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-formula-300x176.jpg 300w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-formula-400x235.jpg 400w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-formula.jpg 421w" data-srcset="http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-formula-200x117.jpg 200w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-formula-300x176.jpg 300w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-formula-400x235.jpg 400w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-formula.jpg 421w" data-sizes="auto" data-orig-sizes="(max-width: 421px) 100vw, 421px" sizes="421px"></a></p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-8 > .CodeMirror, .fusion-syntax-highlighter-8 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-8 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-8 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-8 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_8" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_8" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_8" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark
// Define the UDF

def toFahrenheit (i: Int): Double = { ((i/100d) * 9d/5d + 32d )} // Convert Clesius to Fahrenheit</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99268px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 114px; min-width: 793.121px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Define the UDF</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">def</span> <span class="cm-variable">toFahrenheit</span> (<span class="cm-variable">i</span>: <span class="cm-variable">Int</span>): <span class="cm-variable">Double</span> <span class="cm-operator">=</span> { ((<span class="cm-variable">i</span><span class="cm-operator">/</span><span class="cm-number">100</span><span class="cm-variable">d</span>) <span class="cm-operator">*</span> <span class="cm-number">9</span><span class="cm-variable">d</span><span class="cm-operator">/</span><span class="cm-number">5</span><span class="cm-variable">d</span> <span class="cm-operator">+</span> <span class="cm-number">32</span><span class="cm-variable">d</span> )} <span class="cm-comment">// Convert Clesius to Fahrenheit</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 114px;"></div><div class="CodeMirror-gutters" style="height: 129px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-text fusion-text-15"><p>In Scala we don’t use <span style="color: #0000ff;">return</span> keyword (it is optional). We need to make sure that input to this function should not be a <span style="color: #800000;">null </span>value.</p>
<p>The small <strong><span style="color: #0000ff;">‘d’</span></strong> letter indicates that these values should be represented as <span style="color: #0000ff;">Double</span> and not as <span style="color: #0000ff;">Integer</span>.</p>
</div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:30px;width:100%;"></div><div class="fusion-title title fusion-title-11 sep-underline sep-solid fusion-title-text fusion-title-size-three" style="--awb-sep-color:var(--awb-color4);"><h3 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Step_3_Convert_the_UDF_to_a_SparkSQL">Step 3: Convert the UDF to a SparkSQL UDF</h3></div><div class="fusion-text fusion-text-16"><p>Now that we have defined our UDF logic, we can convert it to a SparkSQL UDF using the <span style="color: #ff6600;"><strong>udf&nbsp;</strong></span>function.</p>
<p>The <strong><span style="color: #ff6600;">udf</span> </strong>function takes a function as an argument and returns a UDF that can be applied to a DataFrame. In this case, we pass our <span style="color: #800080;">toFahrenheit</span> function as an argument, and the <span style="color: #ff6600;">udf</span> function returns a UDF that we can use to convert celsius values to fahrenheit values in our DataFrame.</p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-9 > .CodeMirror, .fusion-syntax-highlighter-9 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-9 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-9 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-9 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_9" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_9" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_9" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark
// Convert the UDF to SparkSQL UDF

val toFahrenheitUDF = udf(toFahrenheit _)</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99268px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 114px; min-width: 348.511px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Convert the UDF to SparkSQL UDF</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">val</span> <span class="cm-variable">toFahrenheitUDF</span> <span class="cm-operator">=</span> <span class="cm-variable">udf</span>(<span class="cm-variable">toFahrenheit</span> <span class="cm-variable">_</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 114px;"></div><div class="CodeMirror-gutters" style="height: 129px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:30px;width:100%;"></div><div class="fusion-title title fusion-title-12 sep-underline sep-solid fusion-title-text fusion-title-size-three" style="--awb-sep-color:var(--awb-color4);"><h3 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Step_4_Apply_the_UDF_to_our_data">Step 4: Apply the UDF to our data</h3></div><div class="fusion-text fusion-text-17"><p>Now that we have defined our UDF, we can apply it to our data. We will add a new column to the weather DataFrame, and apply our UDF to convert each Celsius value.</p>
<p>The temperature values are in hundredths of a degree Celsius, but are expressed as whole integers. We will divide by 100.0 to get whole degrees Celsius and we will round the calculated / converted values to only two decimals.</p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-10 > .CodeMirror, .fusion-syntax-highlighter-10 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-10 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-10 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-10 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_10" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_10" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_10" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark
// Calculate the celcius value : divide by 100.0 to get whole degrees Celsius
// Call the UDF toFahrenheitUDF and add a new column 'fahrenheit'
// Round the values to two decimals only

z.show(
weather
    .withColumn("celsius", $"celsius" / 100)
    .withColumn("celsius", round(col("celsius"), 2))
    .withColumn("fahrenheit", toFahrenheitUDF($"celsius"))
    .withColumn("fahrenheit", round(col("fahrenheit"), 2))
    .select("id", "date", "element", "celsius", "fahrenheit")
    //.show
)</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99316px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 380px; min-width: 634.167px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>14</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Calculate the celcius value : divide by 100.0 to get whole degrees Celsius</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Call the UDF toFahrenheitUDF and add a new column 'fahrenheit'</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Round the values to two decimals only</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">z</span>.<span class="cm-property">show</span>(</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">weather</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    .<span class="cm-property">withColumn</span>(<span class="cm-string">"celsius"</span>, <span class="cm-variable">$</span><span class="cm-string">"celsius"</span> <span class="cm-operator">/</span> <span class="cm-number">100</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    .<span class="cm-property">withColumn</span>(<span class="cm-string">"celsius"</span>, <span class="cm-variable">round</span>(<span class="cm-variable">col</span>(<span class="cm-string">"celsius"</span>), <span class="cm-number">2</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    .<span class="cm-property">withColumn</span>(<span class="cm-string">"fahrenheit"</span>, <span class="cm-variable">toFahrenheitUDF</span>(<span class="cm-variable">$</span><span class="cm-string">"celsius"</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    .<span class="cm-property">withColumn</span>(<span class="cm-string">"fahrenheit"</span>, <span class="cm-variable">round</span>(<span class="cm-variable">col</span>(<span class="cm-string">"fahrenheit"</span>), <span class="cm-number">2</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    .<span class="cm-property">select</span>(<span class="cm-string">"id"</span>, <span class="cm-string">"date"</span>, <span class="cm-string">"element"</span>, <span class="cm-string">"celsius"</span>, <span class="cm-string">"fahrenheit"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    <span class="cm-comment">//.show</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 380px;"></div><div class="CodeMirror-gutters" style="height: 395px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-text fusion-text-18"><p><a href="./Using User-Defined Functions in Spark – DDP Sandbox_files/celsius-fahrenheit-converted-columns.jpg" data-caption=""><img decoding="async" class="alignleft size-full wp-image-4942 lazyautosizes lazyloaded" src="./Using User-Defined Functions in Spark – DDP Sandbox_files/celsius-fahrenheit-converted-columns.jpg" data-orig-src="http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns.jpg" alt="" width="1867" height="328" srcset="http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-200x35.jpg 200w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-300x53.jpg 300w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-400x70.jpg 400w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-600x105.jpg 600w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-768x135.jpg 768w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-800x141.jpg 800w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-1024x180.jpg 1024w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-1200x211.jpg 1200w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-1536x270.jpg 1536w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns.jpg 1867w" data-srcset="http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-200x35.jpg 200w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-300x53.jpg 300w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-400x70.jpg 400w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-600x105.jpg 600w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-768x135.jpg 768w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-800x141.jpg 800w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-1024x180.jpg 1024w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-1200x211.jpg 1200w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns-1536x270.jpg 1536w, http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-converted-columns.jpg 1867w" data-sizes="auto" data-orig-sizes="(max-width: 1867px) 100vw, 1867px" sizes="1140px"></a></p>
</div><div class="fusion-text fusion-text-19"><p>As expected, each value in the <span style="color: #0000ff;">“celsius”</span> column has been converted to Fahrenheit and added to a new column <span style="color: #0000ff;">“fahrenheit”</span>.</p>
</div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:30px;width:100%;"></div><div class="fusion-title title fusion-title-13 sep-underline sep-solid fusion-title-text fusion-title-size-two" style="--awb-sep-color:var(--awb-color4);"><h2 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Registering_the_UDF">Registering the UDF</h2></div><div class="fusion-text fusion-text-20"><p>If we want to reuse our UDF in other parts of our Spark application, we need to register it with Spark using the <span style="color: #0000ff;">spark.udf.register</span> method. Once the UDF registered, Spark will serialize the function on the driver and transfer it over the network to all executor processes.</p>
<p>The first argument to <span style="color: #0000ff;">spark.udf.register</span> is the name of the UDF, and the second argument is the UDF itself.</p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-11 > .CodeMirror, .fusion-syntax-highlighter-11 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-11 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-11 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-11 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_11" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_11" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_11" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark
// Register the UDF with Spark

spark.udf.register("toFahrenheitUDF", toFahrenheitUDF)</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99316px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 114px; min-width: 451.669px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>4</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Register the UDF with Spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">spark</span>.<span class="cm-property">udf</span>.<span class="cm-property">register</span>(<span class="cm-string">"toFahrenheitUDF"</span>, <span class="cm-variable">toFahrenheitUDF</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 114px;"></div><div class="CodeMirror-gutters" style="height: 129px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:25px;width:100%;"></div><div class="fusion-text fusion-text-21"><p>Now, we can use the registered UDF in other parts of our Spark application by referencing it by its name.&nbsp; Then we create a temporary view of the DataFrame using <span style="color: #0000ff;">createOrReplaceTempView</span>, which allows us to query the DataFrame using Spark SQL.</p>
<p>We then write a Spark SQL query that uses our UDF to convert the ‘celsius’ column to the corresponding fahrenheit value. We use the AS keyword to rename the new column to “<span style="color: #0000ff;">fahrenheit</span>” and round the result to only two decimals. Finally, we show the resulting DataFrame using the show method.</p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-12 > .CodeMirror, .fusion-syntax-highlighter-12 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-12 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-12 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-12 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_12" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_12" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_12" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark
// We can use the registered UDF

weather.createOrReplaceTempView("weather")

spark.sql("SELECT celsius, round(toFahrenheitUDF(celsius), 2) as fahrenheit FROM weather")
    .show</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99316px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 194px; min-width: 737.392px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>7</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// We can use the registered UDF</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">weather</span>.<span class="cm-property">createOrReplaceTempView</span>(<span class="cm-string">"weather"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">spark</span>.<span class="cm-property">sql</span>(<span class="cm-string">"SELECT celsius, round(toFahrenheitUDF(celsius), 2) as fahrenheit FROM weather"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">    .<span class="cm-property">show</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 194px;"></div><div class="CodeMirror-gutters" style="height: 209px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:5px;width:100%;"></div><div class="fusion-text fusion-text-22"><p><a href="http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-registered-converted-columns.jpg" data-caption=""><img decoding="async" class="alignleft size-full wp-image-4950 lazyloaded" src="http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-registered-converted-columns.jpg" data-orig-src="http://localhost/wp-content/uploads/2023/12/celsius-fahrenheit-registered-converted-columns.jpg" alt="" width="129" height="281"></a></p>
</div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:35px;width:100%;"></div><div class="fusion-title title fusion-title-14 sep-underline sep-solid fusion-title-text fusion-title-size-two" style="--awb-sep-color:var(--awb-color4);"><h2 class="fusion-title-heading title-heading-left" style="margin:0;text-transform:capitalize;" id="toc_Dropping_the_UDF">Dropping the UDF</h2></div><div class="fusion-text fusion-text-23"><p>Regular memory maintenance is key to running your Spark applications smoothly. One essential good practice is dropping unused Spark SQL views/tables and UDFs.</p>
<p>You drop a user-defined function (UDF) using the<span style="color: #0000ff;"> DROP Function</span> command and drop a View/Table using the <span style="color: #0000ff;">Drop</span> command.</p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-13 > .CodeMirror, .fusion-syntax-highlighter-13 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-13 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-13 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-13 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_13" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_13" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_13" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark
// Cleanup

spark.sql("drop temporary function toFahrenheitUDF")
weather.drop("weather")</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99316px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 141px; min-width: 435.771px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// Cleanup</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">spark</span>.<span class="cm-property">sql</span>(<span class="cm-string">"drop temporary function toFahrenheitUDF"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">weather</span>.<span class="cm-property">drop</span>(<span class="cm-string">"weather"</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 141px;"></div><div class="CodeMirror-gutters" style="height: 156px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:35px;width:100%;"></div><div class="fusion-text fusion-text-24"><p>Stop Spark context to free resources.</p>
</div><style type="text/css" scopped="scopped">.fusion-syntax-highlighter-14 > .CodeMirror, .fusion-syntax-highlighter-14 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-14 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-14 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class="fusion-syntax-highlighter-container fusion-syntax-highlighter-14 fusion-syntax-highlighter-theme-light" style="opacity: 1; margin: 0px; font-size: 14px; border-width: 1px; border-style: solid; border-color: var(--awb-color3);"><div class="syntax-highlighter-copy-code"><span class="syntax-highlighter-copy-code-title" data-id="fusion_syntax_highlighter_14" style="font-size:14px;">Copy to Clipboard</span></div><label for="fusion_syntax_highlighter_14" class="screen-reader-text">Syntax Highlighter</label><textarea class="fusion-syntax-highlighter-textarea code-mirror-initialized" id="fusion_syntax_highlighter_14" data-readonly="nocursor" data-linenumbers="1" data-linewrapping="" data-theme="default" data-mode="text/javascript" style="display: none;">%spark

sc.stop</textarea><div class="CodeMirror cm-s-default" style="width: 100%; height: auto;"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 3.99316px; left: 48.9914px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" disabled="" tabindex="0"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 29px; margin-bottom: -15px; border-right-width: 15px; min-height: 88px; min-width: 78.5787px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 19.9983px; top: 0px; height: 26.5873px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">spark</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -28.9931px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">sc</span>.<span class="cm-property">stop</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 15px; width: 1px; border-bottom: 0px solid transparent; top: 88px;"></div><div class="CodeMirror-gutters" style="height: 103px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div><div class="fusion-separator fusion-full-width-sep" style="align-self: center;margin-left: auto;margin-right: auto;margin-bottom:64px;width:100%;"></div></div></div></div></div><div class="fusion-fullwidth fullwidth-box fusion-builder-row-4-7 fusion-flex-container has-pattern-background has-mask-background nonhundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--link_color: var(--awb-custom_color_3);--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-16 fusion_builder_column_1_1 1_1 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:100%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:20px;--awb-spacing-left-large:40px;--awb-width-medium:100%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-text fusion-text-25"><h2 id="toc_Summary">Summary</h2>
<p>In summary, creating a UDF in Spark is straightforward in Scala. We first define the UDF logic, convert it to a Spark UDF using the <span style="color: #ff6600;"><strong>udf</strong></span> function, and apply it to our data using the <span style="color: #ff6600;">withColumn</span> method. We can also register the UDF with Spark and use it in Spark SQL queries.</p>
</div></div></div></div></div><div class="fusion-fullwidth fullwidth-box fusion-builder-row-4-8 fusion-flex-container has-pattern-background has-mask-background nonhundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--link_color: var(--awb-custom_color_3);--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-17 fusion_builder_column_1_1 1_1 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:100%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:20px;--awb-spacing-left-large:40px;--awb-width-medium:100%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-text fusion-text-26"><p>Open Zeppelin Note</p>
<p><a href="http://localhost:19995/#/notebook/2JG2JSGCK" target="_blank" rel="noopener"><i class="fb-icon-element-1 fb-icon-element fontawesome-icon fa-book-open fas circle-yes fusion-text-flow" style="--awb-circlebordersize:1px;--awb-font-size:21.12px;--awb-width:42.24px;--awb-height:42.24px;--awb-line-height:40.24px;--awb-margin-right:12px;"></i>Using User-Defined Functions In Spark</a></p>
</div></div></div></div></div>
</div></div></div></div></div>
				</div>
			</div>
			</section>
						
					</div>  <!-- fusion-row -->
				</main>  <!-- #main -->
				
				
								
					<div class="fusion-tb-footer fusion-footer"><div class="fusion-footer-widget-area fusion-widget-area"><div class="fusion-fullwidth fullwidth-box fusion-builder-row-5 fusion-flex-container nonhundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-padding-top:32px;--awb-padding-bottom:32px;--awb-background-color:var(--awb-color8);--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-18 fusion_builder_column_2_3 2_3 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:66.666666666667%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:0px;--awb-spacing-left-large:40px;--awb-width-medium:66.666666666667%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-title title fusion-title-15 fusion-sep-none fusion-title-text fusion-title-size-two" style="--awb-text-color:var(--awb-color4);--awb-font-size:18px;"><h2 class="fusion-title-heading title-heading-left sm-text-align-center" style="margin:0;font-size:1em;text-transform:capitalize;">Highly Qualified Big Data Trainers</h2></div></div></div><div class="fusion-layout-column fusion_builder_column fusion-builder-column-19 fusion_builder_column_1_3 1_3 fusion-flex-column fusion-no-small-visibility" style="--awb-bg-size:cover;--awb-width-large:33.333333333333%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:0px;--awb-spacing-left-large:40px;--awb-width-medium:33.333333333333%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-end fusion-content-layout-row"><ul style="--awb-line-height:27.2px;--awb-icon-width:27.2px;--awb-icon-height:27.2px;--awb-icon-margin:11.2px;--awb-content-margin:38.4px;" class="fusion-checklist fusion-checklist-1 fusion-checklist-default type-icons"><li class="fusion-li-item" style=""><span class="icon-wrapper circle-no"><i class="fusion-li-icon fa-envelope fas" aria-hidden="true"></i></span><div class="fusion-li-item-content">
<p><a href="http://localhost/contact-us/"><span style="color: var(--awb-color1); letter-spacing: 2px; line-height: 27.2px; font-size: 12px; font-family: Poppins; font-weight: 600;" data-fusion-font="true" data-fusion-google-font="Poppins" data-fusion-google-variant="600">Contact-US</span></a></p>
</div></li></ul></div></div></div></div><div class="fusion-fullwidth fullwidth-box fusion-builder-row-6 fusion-flex-container nonhundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-padding-top:60px;--awb-padding-bottom:60px;--awb-background-color:var(--awb-color4);--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-20 fusion_builder_column_1_1 1_1 fusion-flex-column" style="--awb-bg-size:cover;--awb-width-large:100%;--awb-margin-top-large:0px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:20px;--awb-spacing-left-large:40px;--awb-width-medium:100%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-image-element " style="text-align:center;--awb-max-width:190px;--awb-caption-title-font-family:var(--h2_typography-font-family);--awb-caption-title-font-weight:var(--h2_typography-font-weight);--awb-caption-title-font-style:var(--h2_typography-font-style);--awb-caption-title-size:var(--h2_typography-font-size);--awb-caption-title-transform:var(--h2_typography-text-transform);--awb-caption-title-line-height:var(--h2_typography-line-height);--awb-caption-title-letter-spacing:var(--h2_typography-letter-spacing);"><span class=" fusion-imageframe imageframe-none imageframe-3 hover-type-none"><a class="fusion-no-lightbox" href="http://localhost/" target="_self" aria-label="dataxper-logo-invoice-bg-transp"><img decoding="async" width="247" height="96" src="./Using User-Defined Functions in Spark – DDP Sandbox_files/dataxper-logo-invoice-bg-transp.png" data-orig-src="http://localhost/wp-content/uploads/2023/07/dataxper-logo-invoice-bg-transp.png" alt="" class="img-responsive wp-image-1730 lazyautosizes ls-is-cached lazyloaded" srcset="http://localhost/wp-content/uploads/2023/07/dataxper-logo-invoice-bg-transp-200x78.png 200w, http://localhost/wp-content/uploads/2023/07/dataxper-logo-invoice-bg-transp.png 247w" data-srcset="http://localhost/wp-content/uploads/2023/07/dataxper-logo-invoice-bg-transp-200x78.png 200w, http://localhost/wp-content/uploads/2023/07/dataxper-logo-invoice-bg-transp.png 247w" data-sizes="auto" data-orig-sizes="(max-width: 640px) 100vw, 247px" sizes="190px"></a></span></div></div></div></div></div><div class="fusion-fullwidth fullwidth-box fusion-builder-row-7 fusion-flex-container nonhundred-percent-fullwidth non-hundred-percent-height-scrolling" style="--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-padding-top:60px;--awb-padding-bottom:60px;--awb-flex-wrap:wrap;"><div class="fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap" style="max-width:calc( 1200px + 80px );margin-left: calc(-80px / 2 );margin-right: calc(-80px / 2 );"><div class="fusion-layout-column fusion_builder_column fusion-builder-column-21 fusion_builder_column_1_1 1_1 fusion-flex-column" style="--awb-padding-top:30px;--awb-bg-size:cover;--awb-border-color:hsla(var(--awb-color8-h),var(--awb-color8-s),calc( var(--awb-color8-l) + 60% ),calc( var(--awb-color8-a) - 72% ));--awb-border-top:1px;--awb-border-style:solid;--awb-width-large:100%;--awb-margin-top-large:60px;--awb-spacing-right-large:40px;--awb-margin-bottom-large:20px;--awb-spacing-left-large:40px;--awb-width-medium:100%;--awb-order-medium:0;--awb-spacing-right-medium:40px;--awb-spacing-left-medium:40px;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:40px;--awb-spacing-left-small:40px;" data-scroll-devices="small-visibility,medium-visibility,large-visibility"><div class="fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column"><div class="fusion-text fusion-text-27" style="--awb-font-size:14px;"><p style="text-align: center;">dataXper permits the use of this sandbox for “educational purposes” only. For any other usage please contact us.</p>
</div><div class="fusion-text fusion-text-28" style="--awb-content-alignment:center;--awb-font-size:14px;"><p>© Copyright 2020 - 2025 |   <a href="http://dataxper.com/" target="_blank">dataXper</a>     |   Some Rights Reserved </p>
</div></div></div></div></div>
</div></div>
																</div> <!-- wrapper -->
		</div> <!-- #boxed-wrapper -->
				<a class="fusion-one-page-text-link fusion-page-load-link" tabindex="-1" href="http://localhost/using-user-defined-functions-in-spark/#" aria-hidden="true">Page load link</a>

		<div class="avada-footer-scripts">
			<script type="text/javascript">var fusionNavIsCollapsed=function(e){var t,n;window.innerWidth<=e.getAttribute("data-breakpoint")?(e.classList.add("collapse-enabled"),e.classList.remove("awb-menu_desktop"),e.classList.contains("expanded")||window.dispatchEvent(new CustomEvent("fusion-mobile-menu-collapsed",{detail:{nav:e}})),(n=e.querySelectorAll(".menu-item-has-children.expanded")).length&&n.forEach(function(e){e.querySelector(".awb-menu__open-nav-submenu_mobile").setAttribute("aria-expanded","false")})):(null!==e.querySelector(".menu-item-has-children.expanded .awb-menu__open-nav-submenu_click")&&e.querySelector(".menu-item-has-children.expanded .awb-menu__open-nav-submenu_click").click(),e.classList.remove("collapse-enabled"),e.classList.add("awb-menu_desktop"),null!==e.querySelector(".awb-menu__main-ul")&&e.querySelector(".awb-menu__main-ul").removeAttribute("style")),e.classList.add("no-wrapper-transition"),clearTimeout(t),t=setTimeout(()=>{e.classList.remove("no-wrapper-transition")},400),e.classList.remove("loading")},fusionRunNavIsCollapsed=function(){var e,t=document.querySelectorAll(".awb-menu");for(e=0;e<t.length;e++)fusionNavIsCollapsed(t[e])};function avadaGetScrollBarWidth(){var e,t,n,l=document.createElement("p");return l.style.width="100%",l.style.height="200px",(e=document.createElement("div")).style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(l),document.body.appendChild(e),t=l.offsetWidth,e.style.overflow="scroll",t==(n=l.offsetWidth)&&(n=e.clientWidth),document.body.removeChild(e),jQuery("html").hasClass("awb-scroll")&&10<t-n?10:t-n}fusionRunNavIsCollapsed(),window.addEventListener("fusion-resize-horizontal",fusionRunNavIsCollapsed);</script><script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/wp-content\/uploads\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/Avada-Child-Theme\/*","\/wp-content\/themes\/Avada\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<link rel="stylesheet" id="wp-codemirror-css" href="./Using User-Defined Functions in Spark – DDP Sandbox_files/codemirror.min.css" type="text/css" media="all">
<link rel="stylesheet" id="code-editor-css" href="./Using User-Defined Functions in Spark – DDP Sandbox_files/code-editor.min.css" type="text/css" media="all">
<script type="text/javascript" src="./Using User-Defined Functions in Spark – DDP Sandbox_files/codemirror.min.js.download" id="wp-codemirror-js"></script>
<script type="text/javascript" src="./Using User-Defined Functions in Spark – DDP Sandbox_files/underscore.min.js.download" id="underscore-js"></script>
<script type="text/javascript" src="./Using User-Defined Functions in Spark – DDP Sandbox_files/code-editor.min.js.download" id="code-editor-js"></script>
<script type="text/javascript" id="code-editor-js-after">
/* <![CDATA[ */
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
jQuery.extend( wp.codeEditor.defaultSettings, {"codemirror":{"indentUnit":4,"indentWithTabs":true,"inputStyle":"contenteditable","lineNumbers":true,"lineWrapping":true,"styleActiveLine":true,"continueComments":true,"extraKeys":{"Ctrl-Space":"autocomplete","Ctrl-\/":"toggleComment","Cmd-\/":"toggleComment","Alt-F":"findPersistent","Ctrl-F":"findPersistent","Cmd-F":"findPersistent"},"direction":"ltr","gutters":[],"mode":""},"csslint":{"errors":true,"box-model":true,"display-property-grouping":true,"duplicate-properties":true,"known-properties":true,"outline-none":true},"jshint":{"boss":true,"curly":true,"eqeqeq":true,"eqnull":true,"es3":true,"expr":true,"immed":true,"noarg":true,"nonbsp":true,"onevar":true,"quotmark":"single","trailing":true,"undef":true,"unused":true,"browser":true,"globals":{"_":false,"Backbone":false,"jQuery":false,"JSON":false,"wp":false}},"htmlhint":{"tagname-lowercase":true,"attr-lowercase":true,"attr-value-double-quotes":false,"doctype-first":false,"tag-pair":true,"spec-char-escape":true,"id-unique":true,"src-not-empty":true,"attr-no-duplication":true,"alt-require":true,"space-tab-mixed-disabled":"tab","attr-unsafe-chars":true}} );
/* ]]> */
</script>
<script type="text/javascript" src="./Using User-Defined Functions in Spark – DDP Sandbox_files/09c58b1334ead1e27a0786080a035584.min.js.download" id="fusion-scripts-js"></script>
				<script type="text/javascript">
				jQuery( document ).ready( function() {
					var ajaxurl = 'http://localhost/wp-admin/admin-ajax.php';
					if ( 0 < jQuery( '.fusion-login-nonce' ).length ) {
						jQuery.get( ajaxurl, { 'action': 'fusion_login_nonce' }, function( response ) {
							jQuery( '.fusion-login-nonce' ).html( response );
						});
					}
				});
				</script>
						</div>

			<section class="to-top-container to-top-right" aria-labelledby="awb-to-top-label">
		<a href="http://localhost/using-user-defined-functions-in-spark/#" id="toTop" class="fusion-top-top-link">
			<span id="awb-to-top-label" class="screen-reader-text">Go to Top</span>

					</a>
	</section>
		

</body></html>